"use strict";(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[9416],{9416:(p,P,s)=>{s.d(P,{ProtectedListPage:()=>ts});var _=s(74081),D=s(27279),e=s(93153),E=s(50086),i=s(32370),C=s(10701),T=s(93415),h=s(4987),r=s(73354),a=s(27875),R=s(48102),L=s(37472),W=s(74758),I=s(70774),Z=s(38566),U=s(38101),K=s(10989),V=s(86967),n=s(87006),S=s(36938),Y=s(78031),J=s(26784),X=s(78665),H=s(53532),G=s(61815),$=s(61020),b=s(51447),N=s(6606),k=s(86492),F=s(42791),rs=s(15816),Ms=s(97442),Os=s(13576),Ps=s(87830),Cs=s(47184),Ts=s(364),hs=s(59461),Rs=s(71563),Ls=s(49204),ms=s(47853),vs=s(74919),gs=s(29206),As=s(40464),Bs=s(98934),cs=s(43433),Ws=s(75719),Is=s(8175),Us=s(6078),Ks=s(51943),xs=s(55783),js=s(92249),fs=s(41942),us=s(22919),ys=s(53915),ps=s(75041),Zs=s(30200),Ss=s(91379),$s=s(33299),Ns=s(33409),Fs=s(63645),zs=s(7988),Qs=s(7055),Vs=s(26757),Ys=s(58311),Js=s(24840),Xs=s(29510),Hs=s(16946),Gs=s(10124),bs=s(69530),ks=s(86961),ws=s(51527),qs=s(19764),s_=s(42982),__=s(26126),t_=s(64797),o_=s(85811);const w=({id:t,name:O,description:l,usersCount:v,icons:g,rowIndex:x,canUpdate:A})=>{const{formatMessage:B}=(0,$.Z)(),[,m]=g,j=B({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:v});return(0,_.jsxs)(e.Tr,{"aria-rowindex":x,...A?(0,n.X7)({fn:m.onClick}):{},children:[(0,_.jsx)(E.Td,{maxWidth:(0,n.Q1)(130),children:(0,_.jsx)(i.Z,{ellipsis:!0,textColor:"neutral800",children:O})}),(0,_.jsx)(E.Td,{maxWidth:(0,n.Q1)(250),children:(0,_.jsx)(i.Z,{ellipsis:!0,textColor:"neutral800",children:l})}),(0,_.jsx)(E.Td,{children:(0,_.jsx)(i.Z,{textColor:"neutral800",children:j})}),(0,_.jsx)(E.Td,{children:(0,_.jsx)(C.k,{justifyContent:"flex-end",...n.UW,children:g.map((d,c)=>d?(0,_.jsx)(T.x,{paddingLeft:c===0?0:1,children:(0,_.jsx)(h.h,{onClick:d.onClick,label:d.label,borderWidth:0,icon:d.icon})},d.label):null)})})]},t)},q=()=>{const{formatMessage:t}=(0,$.Z)();(0,n.go)();const O=(0,N.j)(F.s),{formatAPIError:l}=(0,n.So)(),v=(0,n.lm)(),[g,x]=D.useState(!1),[{query:A}]=(0,n.Kx)(),{isLoading:B,allowedActions:{canCreate:m,canDelete:j,canRead:d,canUpdate:c}}=(0,n.ss)(O.settings?.roles),{roles:z,refetch:os}=(0,k.u)({filters:A?._q?{name:{$containsi:A._q}}:void 0},{refetchOnMountOrArgChange:!0,skip:B||!d}),{push:f}=(0,b.k6)(),[{showModalConfirmButtonLoading:ns,roleToDelete:Es},u]=D.useReducer(_s,ss),{post:as}=(0,n.tg)(),ls=async()=>{try{u({type:"ON_REMOVE_ROLES"}),await as("/admin/roles/batch-delete",{ids:[Es]}),await os(),u({type:"RESET_DATA_TO_DELETE"})}catch(o){o instanceof H.d7&&v({type:"warning",message:l(o)})}y()},Q=()=>f("/settings/roles/new"),y=()=>x(o=>!o),is=o=>M=>{M.preventDefault(),M.stopPropagation(),o.usersCount?v({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):(u({type:"SET_ROLE_TO_DELETE",id:o.id}),y())},ds=o=>M=>{M.preventDefault(),M.stopPropagation(),f(`/settings/roles/duplicate/${o.id}`)},es=z.length+1,Ds=6;return B?(0,_.jsx)(r.o,{children:(0,_.jsx)(n.dO,{})}):(0,_.jsxs)(r.o,{children:[(0,_.jsx)(n.SL,{name:"Roles"}),(0,_.jsx)(a.T,{primaryAction:m?(0,_.jsx)(R.z,{onClick:Q,startIcon:(0,_.jsx)(S.Z,{}),size:"S",children:t({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,title:t({id:"global.roles",defaultMessage:"roles"}),subtitle:t({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),d&&(0,_.jsx)(L.Z,{startActions:(0,_.jsx)(n.m,{label:t({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:t({id:"global.roles",defaultMessage:"roles"})})})}),d&&(0,_.jsx)(W.D,{children:(0,_.jsxs)(I.i,{colCount:Ds,rowCount:es,footer:m?(0,_.jsx)(Z.c,{onClick:Q,icon:(0,_.jsx)(S.Z,{}),children:t({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,children:[(0,_.jsx)(U.h,{children:(0,_.jsxs)(e.Tr,{"aria-rowindex":1,children:[(0,_.jsx)(E.Th,{children:(0,_.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:t({id:"global.name",defaultMessage:"Name"})})}),(0,_.jsx)(E.Th,{children:(0,_.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:t({id:"global.description",defaultMessage:"Description"})})}),(0,_.jsx)(E.Th,{children:(0,_.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:t({id:"global.users",defaultMessage:"Users"})})}),(0,_.jsx)(E.Th,{children:(0,_.jsx)(K.T,{children:t({id:"global.actions",defaultMessage:"Actions"})})})]})}),(0,_.jsx)(V.p,{children:z?.map((o,M)=>(0,_.jsx)(w,{id:o.id,name:o.name,description:o.description,usersCount:o.usersCount,icons:[m&&{onClick:ds(o),label:t({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:(0,_.jsx)(Y.Z,{})},c&&{onClick:()=>f(`/settings/roles/${o.id}`),label:t({id:"app.utils.edit",defaultMessage:"Edit"}),icon:(0,_.jsx)(J.Z,{})},j&&{onClick:is(o),label:t({id:"global.delete",defaultMessage:"Delete"}),icon:(0,_.jsx)(X.Z,{})}].filter(Boolean),rowIndex:M+2,canUpdate:c},o.id))})]})}),(0,_.jsx)(n.QH,{isOpen:g,onConfirm:ls,isConfirmButtonLoading:ns,onToggleDialog:y})]})},ss={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},_s=(t,O)=>(0,G.ZP)(t,l=>{switch(O.type){case"ON_REMOVE_ROLES":{l.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{l.shouldRefetchData=!0,l.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{l.shouldRefetchData=!1,l.roleToDelete=null,l.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{l.roleToDelete=O.id;break}default:return l}}),ts=()=>{const t=(0,N.j)(F.s);return(0,_.jsx)(n.O4,{permissions:t.settings?.roles.main,children:(0,_.jsx)(q,{})})}},86492:(p,P,s)=>{s.d(P,{u:()=>i});var _=s(27279),D=s(87006),e=s(61020),E=s(6606);const i=(C={},T)=>{const{locale:h}=(0,e.Z)(),r=(0,D.Xe)(h,{sensitivity:"base"}),{data:a,error:R,isError:L,isLoading:W,refetch:I}=(0,E.z)(C,T);return{roles:_.useMemo(()=>[...a??[]].sort((U,K)=>r.compare(U.name,K.name)),[a,r]),error:R,isError:L,isLoading:W,refetch:I}}},38566:(p,P,s)=>{s.d(P,{c:()=>r});var _=s(74081),D=s(72450),e=s(93415),E=s(84366),i=s(10701),C=s(32370);const T=(0,D.ZP)(e.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:a})=>a.colors.primary600};
  }
`,h=(0,D.ZP)(e.x)`
  border-radius: 0 0 ${({theme:a})=>a.borderRadius} ${({theme:a})=>a.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,r=({children:a,icon:R,...L})=>(0,_.jsxs)("div",{children:[(0,_.jsx)(E.i,{}),(0,_.jsx)(h,{as:"button",background:"primary100",padding:5,...L,children:(0,_.jsxs)(i.k,{children:[(0,_.jsx)(T,{"aria-hidden":!0,background:"primary200",children:R}),(0,_.jsx)(e.x,{paddingLeft:3,children:(0,_.jsx)(C.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:a})})]})})]})}}]);
